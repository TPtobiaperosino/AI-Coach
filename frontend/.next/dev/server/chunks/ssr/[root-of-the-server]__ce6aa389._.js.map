{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/tobiaperosino/Library/CloudStorage/OneDrive-OxfordBrookesUniversity/Microsoft%20Copilot%20Chat%20Files/Tech%20Projects/running-AI-Coach/frontend/app/page.tsx"],"sourcesContent":["// this will be the front door of the app\n// I need to send the user to Cognito, I'm delegating the authentication to Cognito\n// The login button just sends the browser to Cognito --> it is a redirect\n// If cognito authorises the user and login works, Cognito gives to the browser a code and dends the browser back to the app\n// Code is just used at every login OAuth when a new JWT is needed and lasts a few minutes\n\n// Browser goes back to the app with a URL like \"http://localhost:3000/callback?code=ABC123\" which is the address of the callback page\n// The callback page is made of HTML and JS run by the browser when it goes through the corresponding URL\n// A URL is associated to a page through Next.js --> I create the callback page associated to the URL with the code so browser when it reads it loads the callback page\n// The browser, loads the page and execues the JS inside it. JS finds the code and extracts it.\n// Callback will be used to get the JWT, with a library Auth callback will be read, and then code exchanged with the JWT with Cognito\n\n// The JS, after reading the code calls an Amplify Auth function or a manual fetch --> makes http request to Cognito --> exchanges the code with the JWT\n\n// Just for reference --> fetch is a way to ask data to a server without changing page\n\n// Therefore I need to build a login button that does a redirect for the browser towards Cognito. --> window.location.href = \"https://your-cognito-domain/login?...\";\n// I'll use TypeScript + JSX using react withing the Next.js framework\n\n\"use client\" //Debug ERROR 1 --> the code below runs in the browser so I need to use Client Component\nimport Link from \"next/link\";\nexport default function HomePage() { //defining the page, using export makes this JS code usable from other files. Default means this is the main thing of this file, useful when I import the .default thing. When I want to use something from other files I use import\n  function generateState(): string {\n    const array = new Uint8Array(16); //creating array of 16 cells, each cell = 1 byte --> is a speicial array though, is not for UI (e.g. values admitted from 0 to 255), is a binary array\n    crypto.getRandomValues(array); //object of the browser, is to store safely, is not predictable (Match.random is predicatble). getrandomValues is a method of crypto\n\n    return Array.from(array).map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");  //conversion to an Array adapt to be used in UI\n  }\n  \n  //map replace, toString just translate from hex (e.g. 10 = a), pad start makes sure there are 2 digits to rebuild then the original bytes\n  \n  function handleLogin() { //in React every page is a component = function.\n  //  console.log(\"login clicked\") --> I can remove it, now I know it works in the browser //console = tool of the browser to print messages and see errors in the debug area\n    const state = generateState();\n    sessionStorage.setItem(\"oauth_state\", state); //object of the browser, im saving tsatte in the browser as key value (oauth_state is the key)\n    const cognitoDomain = \"https://ai-coach-user-pool-login.auth.eu-west-2.amazoncognito.com\"\n    const clientId = \"17ior5lk7vcmim6gdp48eu1138\"\n    const redirectUri = encodeURIComponent(\"http://localhost:3000/callback\") // must match esattamente il callback URL in Cognito\n    const scope = encodeURIComponent(\"openid email profile\")\n\n    const url =\n          `${cognitoDomain}/oauth2/authorize` +\n          `?response_type=code` +\n          `&client_id=${clientId}` +\n          `&redirect_uri=${redirectUri}` +\n          `&scope=${scope}` +\n          `&state=${state}`\n\n    window.location.href = url // window is the browser, location is a property of window (current address of the page), href is the url --> so I'm assigning new url basically\n    } //log = print text in the console\n      // in general this function is to track clicks.\n  \n  return ( //telling to react what to show. in button I put onClick in order to call the handlelogin function when clicking the login button.\n    <div> \n      <button onClick={handleLogin}>Login</button>\n      <Link href=\"/signup\" style={{marginLeft: 12}}>\n        Create account\n      </Link>  \n    </div>\n  )\n}\n\n//ERROR 1: on Click does not work and gives error because:\n// Code runs on:\n//1) Server --> remote computer which generates HTML, does not see clicks, browser, does not have browser console\n//2) Browser: Chrome e.g., sees clicks, buttons, eruns JS, can do redirect --> clicks can be seen only in the browser\n// In Next.js pages run on server, not in the browser (this makes everything faster and better SEO)\n// 2 types of component --> (i) Server which is default and (ii) Client which runs in the browser\n// !!!! I need to tell to Next.js that I want this component running on the browser (make it client) --> to do so I need to write at the beginning \"use client\"\n"],"names":[],"mappings":";;;;;AAoBA;AApBA,yCAAyC;AACzC,mFAAmF;AACnF,0EAA0E;AAC1E,4HAA4H;AAC5H,0FAA0F;AAE1F,sIAAsI;AACtI,yGAAyG;AACzG,uKAAuK;AACvK,+FAA+F;AAC/F,qIAAqI;AAErI,wJAAwJ;AAExJ,sFAAsF;AAEtF,qKAAqK;AACrK,sEAAsE;AAEtE,cAAa,wFAAwF;;;AAEtF,SAAS;IACtB,SAAS;QACP,MAAM,QAAQ,IAAI,WAAW,KAAK,sJAAsJ;QACxL,OAAO,eAAe,CAAC,QAAQ,oIAAoI;QAEnK,OAAO,MAAM,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,IAAM,EAAE,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,MAAM,IAAI,CAAC,KAAM,+CAA+C;IACjI;IAEA,yIAAyI;IAEzI,SAAS;QACT,2KAA2K;QACzK,MAAM,QAAQ;QACd,eAAe,OAAO,CAAC,eAAe,QAAQ,8FAA8F;QAC5I,MAAM,gBAAgB;QACtB,MAAM,WAAW;QACjB,MAAM,cAAc,mBAAmB,kCAAkC,oDAAoD;;QAC7H,MAAM,QAAQ,mBAAmB;QAEjC,MAAM,MACA,GAAG,cAAc,iBAAiB,CAAC,GACnC,CAAC,mBAAmB,CAAC,GACrB,CAAC,WAAW,EAAE,UAAU,GACxB,CAAC,cAAc,EAAE,aAAa,GAC9B,CAAC,OAAO,EAAE,OAAO,GACjB,CAAC,OAAO,EAAE,OAAO;QAEvB,OAAO,QAAQ,CAAC,IAAI,GAAG,KAAI,gJAAgJ;IAC3K,EAAE,iCAAiC;IACjC,+CAA+C;IAEnD,qBACE,8OAAC;;0BACC,8OAAC;gBAAO,SAAS;0BAAa;;;;;;0BAC9B,8OAAC,uKAAI;gBAAC,MAAK;gBAAU,OAAO;oBAAC,YAAY;gBAAE;0BAAG;;;;;;;;;;;;AAKpD,EAEA,0DAA0D;CAC1D,gBAAgB;CAChB,iHAAiH;CACjH,qHAAqH;CACrH,mGAAmG;CACnG,iGAAiG;CACjG,+JAA+J"}}]
}